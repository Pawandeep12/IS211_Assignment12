@app.route('/quiz/add', methods=['GET', 'POST'])
def add_quiz():
    if not session.get('logged_in'):
        return redirect(url_for('login'))

    if request.method == 'POST':
        subject = request.form.get('subject')
        num_questions = request.form.get('num_questions')
        quiz_date = request.form.get('quiz_date')
        if not subject or not num_questions or not quiz_date:
            flash('Please fill in all fields.', 'error')
        else:
            new_quiz = Quiz(
                subject=subject, 
                num_questions=int(num_questions), 
                quiz_date=datetime.strptime(quiz_date, '%Y-%m-%d')
            )
            db.session.add(new_quiz)
            db.session.commit()
            flash('Quiz added successfully!', 'success')
            return redirect(url_for('dashboard'))
    return render_template('add_quiz.html')
